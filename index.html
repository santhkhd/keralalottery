<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kerala Lottery Home</title>
  <link href="output.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --card-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      --hover-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    body {
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #e9edf5;
      margin: 0;
      color: #222;
    }
    
    /* Enhanced modern styling */
    .enhanced-card {
      transition: all 0.3s ease;
      border-radius: 16px;
      overflow: hidden;
      border: none;
    }
    .enhanced-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--hover-shadow);
    }
    
    .lottery-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 22px;
      justify-content: center;
      padding: 24px 0 36px 0;
      max-width: 900px;
      margin: 0 auto;
      box-sizing: border-box;
    }
    .lottery-card {
      background: #232946;
      color: #fff;
      border-radius: 16px;
      min-width: 0;
      width: 100%;
      min-height: 110px;
      box-shadow: 0 4px 18px rgba(30,60,120,0.13);
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      align-items: flex-start;
      padding: 0;
      text-decoration: none;
      transition: box-shadow 0.18s, transform 0.18s, background 0.18s;
      overflow: hidden;
      cursor: pointer;
      border: none;
      margin: 0;
    }
    .lottery-card:hover, .lottery-card:active {
      box-shadow: 0 10px 32px rgba(37,99,235,0.22);
      transform: translateY(-2px) scale(1.025);
    }
    .card-top {
      width: 100%;
      background: #232946;
      padding: 22px 16px 10px 16px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
      min-height: 70px;
      box-sizing: border-box;
      position: relative;
    }
    .card-bottom {
      width: 100%;
      background: #fff;
      color: #232946;
      font-size: 1.13em;
      font-weight: 700;
      border-bottom-left-radius: 16px;
      border-bottom-right-radius: 16px;
      padding: 13px 0 10px 0;
      text-align: center;
      letter-spacing: 1.2px;
      box-shadow: 0 2px 8px rgba(37,99,235,0.07);
      /* Improved readability for date */
      color: #1e3a8a;
      font-weight: 800;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    .badge {
      position: absolute;
      top: 10px;
      right: 12px;
      background: #3b82f6;
      color: #fff;
      font-size: 0.82em;
      font-weight: 600;
      padding: 2px 10px;
      border-radius: 7px;
      box-shadow: 0 1px 4px rgba(37,99,235,0.10);
      letter-spacing: 0.5px;
      z-index: 2;
    }
    .new-ribbon {
      position: absolute;
      top: 0;
      left: 0;
      background: #ef233c;
      color: #fff;
      font-size: 0.92em;
      font-weight: bold;
      padding: 3px 18px 3px 10px;
      border-radius: 0 0 14px 0;
      z-index: 2;
      letter-spacing: 1px;
      box-shadow: 0 2px 8px rgba(239,35,60,0.10);
    }
    .lottery-title {
      font-size: 1.13em;
      font-weight: 700;
      margin-bottom: 6px;
      margin-top: 18px;
      letter-spacing: 1.1px;
      width: 100%;
      text-align: center;
      text-shadow: 0 2px 8px rgba(30,60,120,0.10);
      word-break: break-word;
      white-space: normal;
      line-height: 1.25;
      min-height: 2.5em;
      display: block;
    }
    .no-results {
      text-align: center;
      padding: 20px;
      font-size: 1.2em;
      color: #666;
      background: #fff;
      border-radius: 10px;
      margin: 20px auto;
      max-width: 900px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    /* Tab bar enhancements */
    .tab-container {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: 50px;
      padding: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
    
    .tab-btn {
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      font-weight: 600;
      color: #374151;
      background: transparent;
      border: none;
      outline: none;
      cursor: pointer;
      white-space: nowrap;
      margin: 0 0.25rem;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }
    .tab-btn.active {
      background: var(--primary-gradient);
      color: #fff;
      box-shadow: 0 4px 12px rgba(37,99,235,0.25);
    }
    .tab-btn:hover:not(.active) {
      background: rgba(37,99,235,0.1);
      color: #1e3a8a;
    }
    
    /* Live button enhancements */
    .live-btn {
      background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);
      transition: all 0.3s ease;
      border-radius: 12px;
      font-weight: 700;
      box-shadow: 0 4px 12px rgba(255,0,0,0.3);
    }
    .live-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255,0,0,0.4);
    }
    
    @media (max-width: 900px) {
      .lottery-grid {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    @media (max-width: 600px) {
      .lottery-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        padding: 8px 2px 12px 2px;
        max-width: 100vw;
        margin: 0;
      }
      .lottery-card {
        width: 100%;
        min-width: 0;
        max-width: 100vw;
        min-height: 100px;
        border-radius: 14px;
        margin: 0 auto;
      }
      .badge {
        font-size: 0.75em;
        padding: 2px 8px;
        border-radius: 6px;
        top: 8px;
        right: 10px;
      }
      .new-ribbon {
        font-size: 0.85em;
        padding: 2px 10px 2px 7px;
        border-radius: 0 0 8px 0;
      }
      .lottery-title {
        font-size: 0.97em;
        margin-top: 16px;
        min-height: 2.2em;
      }
      /* Improved date readability on mobile */
      .card-bottom {
        font-size: 1em;
        padding: 10px 0 8px 0;
        letter-spacing: 1px;
      }
      
      /* Mobile tab bar */
      .tab-container {
        padding: 4px;
      }
      .tab-btn {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
        margin: 0 0.1rem;
      }
    }
    body { padding-bottom: 60px !important; }
    .scrollbar-hide::-webkit-scrollbar {
      display: none;
    }
    .scrollbar-hide {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }
    #lotteryTabs {
      flex-wrap: nowrap;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      min-width: 100vw;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
  <!-- Header with language switcher -->
  <div class="w-full bg-gradient-to-r from-blue-900 to-blue-500 text-white py-5 px-4 flex items-center justify-between shadow-md relative">
    <span id="header-title" class="text-lg font-bold flex-1 text-center">Kerala Lottery Results</span>
    <div class="flex items-center gap-3">
      <a href="live.html" class="inline-flex items-center bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-3 rounded-lg shadow-lg hover:shadow-xl transition-all duration-200 transform hover:scale-105 live-btn" title="Watch Live Draw">
        <span class="text-sm font-bold animate-pulse">LIVE </span>
      </a>
      <button class="text-2xl bg-transparent border-none text-white hover:bg-blue-800/30 rounded-full p-2 transition" id="langIconBtn" title="Change language">üåê</button>
    </div>
    <div class="hidden fixed top-16 right-4 z-50 bg-white rounded-xl shadow-lg p-6 min-w-[180px]" id="langPopup">
      <div class="font-bold text-blue-700 mb-2">Select Language</div>
      <button class="block w-full text-left py-2 rounded hover:bg-blue-50 lang-popup-btn text-gray-800 font-semibold" data-lang="en">English</button>
      <button class="block w-full text-left py-2 rounded hover:bg-blue-50 lang-popup-btn text-gray-800 font-semibold" data-lang="ml">‡¥Æ‡¥≤‡¥Ø‡¥æ‡¥≥‡¥Ç</button>
      <button class="block w-full text-left py-2 rounded hover:bg-blue-50 lang-popup-btn text-gray-800 font-semibold" data-lang="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</button>
    </div>
  </div>

  <!-- Scrolling Tab Bar for Lottery Categories -->
  <div class="w-full overflow-x-auto bg-white shadow-sm border-b border-gray-200 scrollbar-hide">
    <div class="max-w-4xl mx-auto py-4 px-4">
      <div class="tab-container inline-flex">
        <button class="tab-btn active" data-category="ALL">All</button>
        <button class="tab-btn" data-category="KARUNYA">Karunya</button>
        <button class="tab-btn" data-category="KARUNYA_PLUS">Karunya Plus</button>
        <button class="tab-btn" data-category="SUVARNA_KERALAM">Suvarna Keralam</button>
        <button class="tab-btn" data-category="STHREE_SAKTHI">Sthree Sakthi</button>
        <button class="tab-btn" data-category="DHANALEKSHMI">Dhanalekshmi</button>
        <button class="tab-btn" data-category="SAMRUDHI">Samrudhi</button>
        <button class="tab-btn" data-category="BHAGYATHARA">Bhagyathara</button>
      </div>
    </div>
  </div>

  <div class="w-full px-1 sm:px-4">
    <div class="max-w-4xl mx-auto w-full">
      <!-- Lottery Grid -->
      <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3" id="lottery-grid">
        <!-- Lottery cards will be injected here -->
      </div>
    </div>
  </div>

  <!-- No Results Message -->
  <div id="no-results-message" class="no-results hidden">No lottery results available for today.</div>

  <!-- Bottom Navigation -->
  <nav class="fixed bottom-0 left-0 w-full bg-gray-900 flex justify-around items-center py-2 shadow-lg z-40">
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="index.html">
      <span class="material-icons">home</span>
      <span class="text-xs">Home</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="prediction.html">
      <span class="material-icons">star</span>
      <span class="text-xs">Lucky</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="search.html">
      <span class="material-icons">search</span>
      <span class="text-xs">Search</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="scanner.html">
      <span class="material-icons">qr_code_scanner</span>
      <span class="text-xs">Scanner</span>
    </a>
    <a class="flex flex-col items-center text-blue-300 hover:text-white transition" href="live.html">
      <span class="material-icons">live_tv</span>
      <span class="text-xs">Live</span>
    </a>
  </nav>

  <script>
    // Language logic
    let currentLang = localStorage.getItem('lang') || 'en';
    
    const langStrings = {
      en: 'Kerala Lottery Results',
      ml: '‡¥ï‡µá‡¥∞‡¥≥ ‡¥≤‡µã‡¥ü‡µç‡¥ü‡¥±‡¥ø ‡¥´‡¥≤‡¥Ç',
      ta: '‡Æï‡Øá‡Æ∞‡Æ≥‡Ææ ‡Æ≤‡Ææ‡Æü‡Øç‡Æü‡Æ∞‡Æø ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç'
    };
    
    // Short language strings for mobile
    const langStringsShort = {
      en: 'Kerala Lottery',
      ml: '‡¥ï‡µá‡¥∞‡¥≥ ‡¥≤‡µã‡¥ü‡µç‡¥ü‡¥±‡¥ø',
      ta: '‡Æï‡Øá‡Æ∞‡Æ≥‡Ææ ‡Æ≤‡Ææ‡Æü‡Øç‡Æü‡Æ∞‡Æø'
    };
    
    // Lottery name translations
    const lotteryNameTranslations = {
      SAMRUDHI: { en: 'SAMRUDHI', ml: '‡¥∏‡¥Æ‡µÉ‡¥¶‡µç‡¥ß‡¥ø', ta: '‡Æö‡ÆÆ‡Øç‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æø' },
      BHAGYATHARA: { en: 'BHAGYATHARA', ml: '‡¥≠‡¥æ‡¥ó‡µç‡¥Ø‡¥§‡¥æ‡¥∞', ta: '‡Æ™‡Ææ‡Æï‡Øç‡ÆØ‡Æ§‡Ææ‡Æ∞‡Ææ' },
      STHREE_SAKTHI: { en: 'STHREE-SAKTHI', ml: '‡¥∏‡µç‡¥§‡µç‡¥∞‡µÄ-‡¥∂‡¥ï‡µç‡¥§‡¥ø', ta: '‡Æ∏‡Øç‡Æ§‡Øç‡Æ∞‡ØÄ-‡Æö‡Æï‡Øç‡Æ§‡Æø' },
      DHANALEKSHMI: { en: 'DHANALEKSHMI', ml: '‡¥ß‡¥®‡¥≤‡¥ï‡µç‡¥∑‡µç‡¥Æ‡¥ø', ta: '‡Æ§‡Æ©‡Æ≤‡Æü‡Øç‡Æö‡ØÅ‡ÆÆ‡Æø' },
      KARUNYA_PLUS: { en: 'KARUNYA PLUS', ml: '‡¥ï‡¥∞‡µÅ‡¥£‡µç‡¥Ø ‡¥™‡µç‡¥≤‡¥∏‡µç', ta: '‡Æï‡Æ∞‡ØÅ‡Æ£‡Øç‡ÆØ‡Ææ ‡Æ™‡Æø‡Æ≥‡Æ∏‡Øç' },
      SUVARNA_KERALAM: { en: 'SUVARNA KERALAM', ml: '‡¥∏‡µÅ‡¥µ‡µº‡¥£ ‡¥ï‡µá‡¥∞‡¥≥‡¥Ç', ta: '‡Æö‡ØÅ‡Æµ‡Æ∞‡Øç‡Æ£ ‡Æï‡Øá‡Æ∞‡Æ≥‡ÆÆ‡Øç' },
      KARUNYA: { en: 'KARUNYA', ml: '‡¥ï‡¥∞‡µÅ‡¥£‡µç‡¥Ø', ta: '‡Æï‡Æ∞‡ØÅ‡Æ£‡Øç‡ÆØ‡Ææ' }
    };

    // Days with no draws (holidays)
    const noDrawDays = [
     
    ];

    function setLang(lang) {
      currentLang = lang;
      localStorage.setItem('lang', lang);
      updateHeaderTitle();
      document.title = langStrings[lang] || langStrings['en'];
      renderLotteryCards(lang);
    }

    function updateHeaderTitle() {
      const w = window.innerWidth;
      if (w < 400) {
        document.getElementById('header-title').textContent = langStringsShort[currentLang] || langStringsShort['en'];
      } else {
        document.getElementById('header-title').textContent = langStrings[currentLang] || langStrings['en'];
      }
    }

    window.addEventListener('resize', updateHeaderTitle);

    // Language popup setup
    document.addEventListener('DOMContentLoaded', function() {
      const langIconBtn = document.getElementById('langIconBtn');
      const langPopup = document.getElementById('langPopup');
      const langPopupBtns = langPopup.querySelectorAll('.lang-popup-btn');
      
      langIconBtn.addEventListener('click', function(e) {
        e.stopPropagation();
        langPopup.classList.toggle('hidden');
      });
      
      document.body.addEventListener('click', function(e) {
        if (!langPopup.contains(e.target) && e.target !== langIconBtn) {
          langPopup.classList.add('hidden');
        }
      });
      
      langPopupBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          setLang(this.getAttribute('data-lang'));
          langPopup.classList.add('hidden');
        });
      });
      
      setLang(currentLang);
    });

    async function renderLotteryCards(lang, filterCategory = 'ALL') {
      let cardData = [];
      const bumperLotteries = [
        {
          name: 'NEW YEAR BUMPER',
          shortName: 'NY',
          drawNumber: 'XX',
          date: '2026-01-15',
          translations: { en: 'NEW YEAR BUMPER', ml: '‡¥™‡µÅ‡¥§‡µÅ‡¥µ‡¥§‡µç‡¥∏‡¥∞ ‡¥¨‡¥Æ‡µç‡¥™‡µº', ta: '‡Æ™‡ØÅ‡Æ§‡Øç‡Æ§‡Ææ‡Æ£‡Øç‡Æü‡ØÅ ‡Æ™‡ÆÆ‡Øç‡Æ™‡Æ∞‡Øç' }
        },
        {
          name: 'SUMMER BUMPER',
          shortName: 'SB',
          drawNumber: 'XX',
          date: '2026-03-20',
          translations: { en: 'SUMMER BUMPER', ml: '‡¥µ‡µá‡¥®‡µΩ ‡¥¨‡¥Æ‡µç‡¥™‡µº', ta: '‡Æï‡Øã‡Æü‡Øà ‡Æ™‡ÆÆ‡Øç‡Æ™‡Æ∞‡Øç' }
        },
        {
          name: 'MONSOON BUMPER 2025',
          shortName: 'BR',
          drawNumber: '104',
          date: '2025-07-23',
          translations: { en: 'MONSOON BUMPER 2025', ml: '‡¥Æ‡µ∫‡¥∏‡µÇ‡µ∫ ‡¥¨‡¥Æ‡µç‡¥™‡µº 2025', ta: '‡ÆÆ‡Ææ‡Æ©‡Øç‡Æö‡ØÇ‡Æ©‡Øç ‡Æ™‡ÆÆ‡Øç‡Æ™‡Æ∞‡Øç 2025' }
        }
      ];
      const catMap = {
        'SAMRUDHI': 'SM',
        'BHAGYATHARA': 'BT',
        'STHREE_SAKTHI': 'SS',
        'DHANALEKSHMI': 'DL',
        'KARUNYA_PLUS': 'KN',
        'SUVARNA_KERALAM': 'SK',
        'KARUNYA': 'KR'
      };
      const now = new Date();
      const istTime = new Date(now.getTime() + (330 * 60 * 1000));
      const today = new Date(Date.UTC(istTime.getUTCFullYear(), istTime.getUTCMonth(), istTime.getUTCDate()));
      const todayStr = today.toISOString().split('T')[0];
      const noResultsMessage = document.getElementById('no-results-message');
      let hasTodayResult = false;

      // Fetch manifest
      let manifest = [];
      try {
        const res = await fetch('result_manifest.json');
        manifest = await res.json();
      } catch (e) {
        noResultsMessage.textContent = 'Could not load results manifest.';
        noResultsMessage.classList.remove('hidden');
        return;
      }

      // Add bumper lotteries if filter is ALL and present in manifest
      if (filterCategory === 'ALL') {
        bumperLotteries.forEach(bumper => {
          const m = manifest.find(x => x.code === bumper.shortName && x.date === bumper.date);
          if (m) {
            const isNew = (bumper.date === todayStr);
            if (isNew) hasTodayResult = true;
            const translatedName = bumper.translations[lang] || bumper.translations['en'];
            cardData.push({
              date: bumper.date,
              html: `
                <a class="lottery-card enhanced-card" href="result.html?file=${m.filename}">
                  <div class="card-top">
                    ${isNew ? `<span class="new-ribbon">NEW</span>` : ''}
                    <span class="badge">${bumper.shortName}-${bumper.drawNumber}</span>
                    <div class="lottery-title">${translatedName}</div>
                  </div>
                  <div class="card-bottom">${bumper.date.split('-').reverse().join('/')}</div>
                </a>
              `
            });
          }
        });
      }

      // Filter manifest for regular draws
      let filtered = manifest.filter(item => {
        if (filterCategory === 'ALL') return true;
        // Map tab category to code
        const catMap = {
          'SAMRUDHI': 'SM',
          'BHAGYATHARA': 'BT',
          'STHREE_SAKTHI': 'SS',
          'DHANALEKSHMI': 'DL',
          'KARUNYA_PLUS': 'KN',
          'SUVARNA_KERALAM': 'SK',
          'KARUNYA': 'KR'
        };
        return item.code === catMap[filterCategory];
      });

      // Only show results up to today
      filtered = filtered.filter(item => item.date <= todayStr);

      // Add cards for filtered draws
      filtered.forEach(item => {
        // Skip bumper draws already handled
        if (bumperLotteries.some(b => b.shortName === item.code && b.date === item.date)) return;
        const isNew = (item.date === todayStr);
        if (isNew) hasTodayResult = true;
        // Find translated name - simplified logic
        let translatedName = item.code;
        // Try to find a matching translation
        for (const [cat, val] of Object.entries(lotteryNameTranslations)) {
          const catCode = catMap[cat];
          if (catCode && catCode === item.code) {
            translatedName = val[lang] || val.en || item.code;
            break;
          }
        }
        cardData.push({
          date: item.date,
          html: `
            <a class="lottery-card enhanced-card" href="result.html?file=${item.filename}">
              <div class="card-top">
                ${isNew ? `<span class="new-ribbon">NEW</span>` : ''}
                <span class="badge">${item.code}-${item.draw_number}</span>
                <div class="lottery-title">${translatedName}</div>
              </div>
              <div class="card-bottom">${item.date.split('-').reverse().join('/')}</div>
            </a>
          `
        });
      });

      // Sort cards by date, newest first
      cardData.sort((a, b) => new Date(b.date) - new Date(a.date));

      const grid = document.getElementById('lottery-grid');
      grid.innerHTML = cardData.map(c => c.html).join('');

      // Show/hide no results message
      noResultsMessage.classList.toggle('hidden', hasTodayResult || filterCategory !== 'ALL');
    }

    document.addEventListener('DOMContentLoaded', function() {
      setLang(currentLang);
      updateHeaderTitle();
      renderLotteryCards(currentLang);
    });

    // Tab bar filtering logic
    document.addEventListener('DOMContentLoaded', function() {
      const tabs = document.querySelectorAll('.tab-btn');
      tabs.forEach(tab => {
        tab.addEventListener('click', function() {
          tabs.forEach(t => t.classList.remove('active'));
          this.classList.add('active');
          const category = this.getAttribute('data-category');
          renderLotteryCards(currentLang, category);
        });
      });
    });
  </script>
</body>
</html>
